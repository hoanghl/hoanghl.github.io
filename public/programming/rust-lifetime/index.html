<!doctype html><html lang=en><head data-base-url=https://hoanghl.io/ data-build-search-index=true data-comments-enabled=true data-giscus-category=General data-giscus-category-id=DIC_kwDOLQ4cp84CdIjK data-giscus-crossorigin=anonymous data-giscus-emit-metadata=0 data-giscus-input-position=bottom data-giscus-lang=en data-giscus-mapping=url data-giscus-nonce data-giscus-reactions-enabled=0 data-giscus-repo=kuznetsov17/pico data-giscus-repo-id=R_kgDOLQ4cpw data-giscus-src=https://giscus.app/client.js data-giscus-strict=0><meta charset=utf-8><title>Lifetime in Rust</title><script src=https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js></script><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.css integrity=sha384-o3WH+1yEhq+grOgz1BVYTZPyTlMXrDxnjN1By9/ba94JqJhva6wFm2Hb+URQX53v rel=stylesheet><script crossorigin defer integrity=sha384-C5yZTsgLOfuizO9kb+hrB8uSBwwvZ4yenKWU0KmWl+7bkL6Tph/KbcOa3S4zdoRE src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.js></script><script crossorigin defer integrity=sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js></script><script crossorigin defer integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh onload=renderMathInElement(document.body); src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js></script><link href=https://hoanghl.io/site.css rel=stylesheet><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.css integrity=sha384-o3WH+1yEhq+grOgz1BVYTZPyTlMXrDxnjN1By9/ba94JqJhva6wFm2Hb+URQX53v rel=stylesheet><meta content="Some Description" name=description><meta content="Hoang Le" name=author><meta content=programming,rust name=keywords><link href="https://hoanghl.io/css/grid.css?v=29062025103816" rel=stylesheet><link href="https://hoanghl.io/css/style.css?v=29062025103816" rel=stylesheet><link href=https://hoanghl.io/images/letter.jpg rel=icon type=image/png><link href=https://hoanghl.io/images/letter.jpg rel=mask-icon type=image/png><script src="https://hoanghl.io/js/codecopy.js?v=29062025103816"></script><script src="https://hoanghl.io/js/mermaid.min.js?v=29062025103816"></script><script src="https://hoanghl.io/elasticlunr.min.js?v=29062025103816"></script><script src="https://hoanghl.io/js/search.js?v=29062025103816"></script><body><header><div class=container id=header-container><div class=row><div class=col-2></div><div class=col-8 id=top><div id=menu><ul><li><a href=https://hoanghl.io/>home</a><li><a class=active href=https://hoanghl.io/programming>programming</a><li><a href=https://hoanghl.io/data-world>data-world</a></ul></div><div id=searchBox><span class="icon icon-search head"></span><input id=searchInput name=search></div><span class="icon head" id=cIcon></span></div><div class=col-2></div></div></div></header><div class=row><div class=col-12><div id=sResults><ul class=search-results id=sResultsUL></ul></div></div></div><main><div class=container id=main-container><div class=row><div class=col-2></div><div class="col-8 content"><h1 class=center>Lifetime in Rust</h1><span class=post-tags> <ul><li><a class=singlepost-tags href=https://hoanghl.io/tags/rust/>#rust</a> <li><a class=singlepost-tags href=https://hoanghl.io/tags/programming/>#programming</a> </ul> </span><div><p>Note: This discussion is within the context of safe Rust. It only focuses on reference, not pointer.<p>Outline<ol><li>Starting with the problem of function’s returning references</ol><p>Impossible > Returned value must be either:<ul><li>From arguments<li>Globally available</ul><ol start=2><li>Purpose of lifetime</ol><ul><li>avoid Dangling pointer</ul><ol start=3><li>Impacts of lifetime:</ol><ul><li>not affect the internal code of the function but instead constraint on 2 things: <ul><li>The variable passed as arguments to the function<li>The returned value of the function</ul></ul><p>not affect the internal code: It doesn’t change how long any of reference live but describe the relationship of lifetimes of multiple references to each other.<p>Lifetime is similar to the typing of argument and returned value in the extent that they both specify the constrains that must be satisfied as calling the function. As calling a function, the caller must ensure that the variables as the argument follow the type specified in the function prototype. In turn, as calling the function and receiving the returned reference, the caller will know that the returned reference either lives as long as at least one of the arguments or is the static reference.<p>Corollary impact: facility the compiler (i.e. the Borrow checker) as checking the reference problem. Since the function has already constrained on the relationship of the reference, the problem, if exists, must derive from the other things outside the function such as the variables passing as arguments.<p>Example of compiler’s being aware of the internal code of the function:<pre class=language-rust data-lang=rust style=color:#eff;background-color:#212121><code class=language-rust data-lang=rust><span style=color:#4a4a4a;font-style:italic>// ================================================
</span><span style=color:#4a4a4a;font-style:italic>// Permitted
</span><span style=color:#4a4a4a;font-style:italic>// ================================================
</span><span>
</span><span style=color:#c792ea;font-style:italic>fn </span><span style=color:#82aaff>longest_permitted_2</span><span style=color:#89ddff><</span><span style=color:#c792ea>'a</span><span>, </span><span style=color:#c792ea>'b</span><span>, </span><span style=color:#c792ea>'c</span><span style=color:#89ddff>>() -> &</span><span style=color:#c792ea>'c </span><span style=color:#c792ea;font-style:italic>str </span><span style=color:#89ddff>{
</span><span>    </span><span style=color:#c792ea;font-style:italic>if </span><span style=color:#f78c6c>1 </span><span style=color:#89ddff>> </span><span style=color:#f78c6c>2 </span><span style=color:#89ddff>{
</span><span>        </span><span style=color:#89ddff>"</span><span style=color:#c3e88d>bad</span><span style=color:#89ddff>"
</span><span>    </span><span style=color:#89ddff>} </span><span style=color:#c792ea;font-style:italic>else </span><span style=color:#89ddff>{
</span><span>        </span><span style=color:#89ddff>"</span><span style=color:#c3e88d>good</span><span style=color:#89ddff>"
</span><span>    </span><span style=color:#89ddff>}
</span><span style=color:#89ddff>}
</span><span>
</span><span style=color:#4a4a4a;font-style:italic>// ================================================
</span><span style=color:#4a4a4a;font-style:italic>// Forbidden
</span><span style=color:#4a4a4a;font-style:italic>// ================================================
</span><span>
</span><span style=color:#c792ea;font-style:italic>fn </span><span style=color:#82aaff>longest_forbidden_5</span><span style=color:#89ddff><</span><span style=color:#c792ea>'a</span><span>, </span><span style=color:#c792ea>'b</span><span>, </span><span style=color:#c792ea>'c</span><span style=color:#89ddff>>(</span><span style=color:#f78c6c>x</span><span style=color:#89ddff>: &</span><span style=color:#c792ea>'a </span><span style=color:#c792ea;font-style:italic>str</span><span>, </span><span style=color:#f78c6c>y</span><span style=color:#89ddff>: &</span><span style=color:#c792ea>'b </span><span style=color:#c792ea;font-style:italic>str</span><span style=color:#89ddff>) -> &</span><span style=color:#c792ea>'c </span><span style=color:#c792ea;font-style:italic>str </span><span style=color:#89ddff>{
</span><span>    y
</span><span style=color:#89ddff>}
</span></code></pre><pre class=language-python data-lang=python style=color:#eff;background-color:#212121><code class=language-python data-lang=python><span>a </span><span style=color:#89ddff>= </span><span style=color:#f78c6c>10
</span></code></pre><p>Borrow Checker examines the internal code to check the validity of the lifetime constraint. In the above snipper, since the returned value inside the function body are static references (i.e. a reference to a static value - which outlives than even the <code>main</code> function) and the lifetime of the returned reference is explicitly specified in the function prototype, Borrow Checker allows this snippet. OTOH, in the body of the below function, the returned value is one of the argument and Borrow Checker sees that the lifetime constraint of this argument doesn’t align with the lifetime constraint of the returned reference, Checker then throws an error.</div></div><div class=col-2></div></div><div class="row postnav"><div class=col-2></div><div class=col-8><div class="col-6 left"><a class=postnav href=https://hoanghl.io/programming/rust-ownership/>← Ownership, pointer and reference</a></div><div class="col-6 right"></div></div><div class=col-2></div></div></div><div class=row><div class=col-2></div><div class=col-8 id=giscusWidget></div></div></main><script src="https://hoanghl.io/js/colortheme.js?v=29062025103816"></script><script src="https://hoanghl.io/js/init.js?v=29062025103816"></script>